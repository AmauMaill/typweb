var l=Object.defineProperty;var g=(i,e,t)=>e in i?l(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var s=(i,e,t)=>g(i,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&a(r)}).observe(document,{childList:!0,subtree:!0});function t(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(n){if(n.ep)return;n.ep=!0;const o=t(n);fetch(n.href,o)}})();const h={"nav.home":{en:"Home",fr:"Accueil"},"nav.about":{en:"About",fr:"Ã€ propos"},"nav.projects":{en:"Projects",fr:"Projets"},"nav.contact":{en:"Contact",fr:"Contact"}};class u{constructor(){s(this,"currentLang");s(this,"LANG_KEY","preferred_language");s(this,"basePath");const e=localStorage.getItem(this.LANG_KEY);this.currentLang=e||this.getBrowserLanguage(),this.basePath=this.getBasePath(),this.updateHtmlLang()}getBasePath(){const t=window.location.pathname.split("/")[1];return t?`/${t}`:""}getBrowserLanguage(){return navigator.language.split("-")[0]==="fr"?"fr":"en"}getCurrentLanguage(){return this.currentLang}toggleLanguage(){this.currentLang=this.currentLang==="en"?"fr":"en",localStorage.setItem(this.LANG_KEY,this.currentLang),this.updateHtmlLang(),this.updatePageText()}updateHtmlLang(){document.documentElement.lang=this.currentLang}translate(e){const t=h[e];return t?t[this.currentLang]:(console.warn(`Translation missing for key: ${e}`),e)}async loadPageContent(e){try{const t=e.replace(/^\/+|\/+$/g,"");console.log(`Loading page ${t} in ${this.currentLang}`);let a;a=`${this.basePath}/pages/${this.currentLang}/${t}.html`,console.log("Attempting to load:",a);let n=await fetch(a);if(!n.ok&&this.currentLang!=="en"){console.log(`No ${this.currentLang} version found for ${t}, trying English...`);const r=`${this.basePath}/pages/en/${t}.html`;if(console.log("Attempting English fallback:",r),n=await fetch(r),!n.ok)throw new Error(`Page ${t} not found in any language`)}let o=await n.text();if(o.includes("<!DOCTYPE html>")||o.includes("<html")){console.warn("Received full HTML document instead of content fragment");const r=document.createElement("div");r.innerHTML=o;const c=r.querySelector(".page-content, main, .content, #content");c&&(o=c.innerHTML)}return console.log("Processed content:",o.substring(0,100)+"..."),o}catch(t){return console.error("Error loading page:",t),'<div class="error">Error loading page content</div>'}}updatePageText(){document.querySelectorAll(".nav-link").forEach(a=>{const n=a.getAttribute("data-translate-key");n&&(a.textContent=this.translate(n))});const t=document.getElementById("langToggle");t&&(t.textContent=this.currentLang.toUpperCase())}}class d{constructor(){s(this,"currentPage","home");s(this,"contentDiv");s(this,"navLinks");s(this,"languageService");s(this,"langToggle");s(this,"basePath");this.contentDiv=document.getElementById("content"),this.navLinks=document.querySelectorAll(".nav-link"),this.langToggle=document.getElementById("langToggle"),this.languageService=new u,this.basePath=this.getBasePath(),this.initializeEventListeners(),this.loadInitialPage()}getBasePath(){const t=window.location.pathname.split("/")[1];return t?`/${t}`:""}initializeEventListeners(){this.navLinks.forEach(e=>{e.addEventListener("click",t=>{t.preventDefault();const a=e.dataset.page||"home";this.navigateToPage(a)})}),this.langToggle&&this.langToggle.addEventListener("click",()=>{this.languageService.toggleLanguage(),this.loadPage(this.currentPage)}),window.addEventListener("popstate",e=>{var a;const t=((a=e.state)==null?void 0:a.page)||"home";this.loadPage(t)})}async loadInitialPage(){const e=window.location.pathname;let t=e.replace(this.basePath,"");t=t.replace(/^\/+|\/+$/g,"");const a=t===""?"home":t;console.log("Initial page load:",{fullPath:e,pagePath:t,page:a}),await this.loadPage(a)}async navigateToPage(e){const t=e==="home"?this.basePath||"/":`${this.basePath}/${e}`;history.pushState({page:e},"",t),await this.loadPage(e)}async loadPage(e){try{console.log("Loading page:",e);const t=await this.languageService.loadPageContent(e);this.contentDiv&&(this.contentDiv.innerHTML=t),this.currentPage=e,this.updateActiveNavLink(),this.initializePageFeatures()}catch(t){console.error("Error loading page:",t),this.contentDiv.innerHTML="<h1>Page Not Found</h1>"}}updateActiveNavLink(){this.navLinks.forEach(e=>{const t=e.dataset.page===this.currentPage;e.classList.toggle("active",t)})}initializePageFeatures(){const e=document.getElementById("themeToggle");e&&e.addEventListener("click",()=>this.toggleTheme());const t=document.getElementById("contactForm");t&&t.addEventListener("submit",a=>this.handleFormSubmit(a))}toggleTheme(){document.body.classList.toggle("dark-theme");const e=document.body.classList.contains("dark-theme");localStorage.setItem("theme",e?"dark":"light")}async handleFormSubmit(e){e.preventDefault();const t={name:document.getElementById("name").value,email:document.getElementById("email").value,message:document.getElementById("message").value};try{console.log("Form submitted:",t),e.target.reset(),alert("Message sent successfully!")}catch(a){console.error("Error submitting form:",a),alert("Failed to send message. Please try again.")}}}window.addEventListener("DOMContentLoaded",()=>{new d});
